<!DOCTYPE html>
<html>
<head>
  <title>Dashboard</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>

<h1>Your Spotify Playlists</h1>

<!-- ✅ GLOBAL YouTube Connect Button (ONLY ONCE) -->
<a href="/auth/youtube" style="display:inline-block; margin-bottom:20px;">
  <button>Connect YouTube</button>
</a>

<% playlists.forEach(playlist => { %>
  <div class="playlist">
    <h2><%= playlist.name %></h2>
    <p>Total Songs: <%= playlist.tracks.total %></p>

    <!-- Test Match -->
    <a href="/match/<%= playlist.id %>" target="_blank">
      <button type="button">Test Match</button>
    </a>

    <!-- Transfer Playlist -->
    <form
      action="/transfer/<%= playlist.id %>"
      method="POST"
      onsubmit="showLoader(this)"
      style="display:inline;"
    >
      <button type="submit">Transfer</button>
      <span class="loader" style="display:none;">
        Transferring… please wait
      </span>
    </form>

  </div>
<% }) %>

<script>
  function showLoader(form) {
    const loader = form.querySelector(".loader");
    if (loader) loader.style.display = "inline";
  }
</script>

</body>
</html>
